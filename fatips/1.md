| FATIP | Title                       | Status | Category       | Author                             | Requires | Created    |
| ----- | --------------------------- | ------ | -------------- | ---------------------------------- | -------- | ---------- |
| 1     | Non-Fungible Token Standard | Draft  | Token Standard | Devon Katz \<<devonk@dbgrow.com>\> | -        | 2018-07-27 |



# Overview

This document describes the **FAT-1** token standard: A non-fungible token standard. This this standard allows for token systems supporting unique, indivisible tokens issued in whole units. It's functionality is most equivalent the ERC-721 token standard of Ethereum.


# Motivation

Extend upon the FAT-0 standard by offering non-fungible token functionality for
unique, indivisible, and traceable assets.

Applications include modeling equity, commodities, financial instruments, and
digital goods.


# Specification


## Token ID  `extends` [FATIP-0](0.md)

## Addresses `extends` [FATIP-0](0.md)

Instead of crediting and debiting numeric quantities of tokens as in FATIP-0, this standard credits and debits token IDs to and from addresses. As such, address balances are represented as an array of owned token IDs.




## Token Chain `extends` [FATIP-0](0.md)


### Token Issuance Entry `extends` [FATIP-0](0.md)

FAT-1 token issuance entries include an additional `tokens` field, which is an
array of unique individual token objects being issued.




#### Individual FAT-1 Tokens

Each token in the `tokens` field must contain a unique `id` within the scope of this
issuance. I.e if FAT-1 token type A is created, having two individual tokens issued on it with the `id` `0` is illegal. The second issuance will be invalid.

No content enforcements are placed on `id`, so as to allow the issuer to integrate their FAT-1 issuance into existing business practices if needed. It's best to choose short IDs since doing so maximizes the amount of
tokens that can be issued in a single issuance, if possible. As with any Factom entry, a maximum of 10KB of FAT-1 token issuance content is possible. Large quantity issuances in excess of that limit should be split into multiple entries.

Note that issuing a token does not place the token into the circulating supply. Once
issued the token can be sent via coinbase transaction by `id` to it's initial
bearer. If `supply` is enforced, the issuer can only issue up to `supply` count of individual tokens. In the edge case of a batch issuance pushing the total supply over `supply`, the cutoff is calculated from the 0th token in the array.

Token issuance entries are ongoing like transaction entries to allow ongoing issuance of tokens by the issuer.


#### Issuance Entry Content Example `extends` [FATIP-0](0.md)

```json
{
  "type": "FAT-1",
  "supply": 10000000,
  "name": "Example Non-Fungible Token",
  "symbol": "EXTNF",
  "tokens":[
      {
          "id":"0"
      },
      {
          "id":"1",
          "metadata":{
              "message":"I'm #1!!!"
          }
      }
  ],
  "salt": "874220a808090fb736f345dd5nmjsfieuwnff129c9f51b708b05cdc4d42f65aae",
}
```

#### Issuance Entry Field Summary & Validation

| Name               | Type   | Description                                                  | Validation                                | Required |
| ------------------ | ------ | ------------------------------------------------------------ | ----------------------------------------- | -------- |
| type               | string | The type of this token issuance                              | Must equal 'FAT-1'                        | Y        |
| supply             | number | The maximum possible number of tokens that can be in circulation. If omitted the supply is infinite. | Must be > 0                               | N        |
| name               | string | The display name of the token                                |                                           | N        |
| symbol             | string | The display symbol of the token                              | must be A-Z, and 1-4 characters in length | N        |
| tokens             | array  | An array of token objects, representing tokens being issued  | Must be an array of objects               | N        |
| tokens[n].id       | string | The unique ID of the token being issued                      | Length > 0                                | Y        |
| tokens[n].metadata | object | Object holding user defined key-value pairs                  |                                           | N        |
| salt               | string | Random string to salt the issuance                           | user defined. Optional                    | N        |

#### Issuance Entry External IDs Summary & Validation

| External ID Index | Type            | Description                                                  | Validation                                                   | Required |
| ----------------- | --------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | -------- |
| 0                 | raw binary data | Raw ed25519 signature output of signing issuance `chainID` + entry content. | ed25519 signature validation (`chainID`+ entry content, `idKey`, `ExtID[0]`) | Y        |




### Token Transaction Entry `extends` [FATIP-0](0.md)

Transaction entries of FAT-1 tokens contain a `ids` field in each of the members of the`inputs` and `outputs` arrays, which denote the collection the token IDs being used as an input or output. FAT-1 replaces the `amount ` field with `ids`.


#### Transaction Entry Content Example

```json
{
    "inputs:": [
        {
            "address": "FA1zT4aFpEvcnPqPCigB3fvGu4Q4mTXY22iiuV69DqE1pNhdF2MC",
            "ids": ["0"]
        },
        {
            "address": "FA2y6VYYPR9Y9Vyy1ZuZqWWRXGXLeuvsLWGkDxq3Ed7yc11dbBKV",
            "ids": ["1"]
        }
    ],
    "outputs:": [
        {
            "address": "FA3aECpw3gEZ7CMQvRNxEtKBGKAos3922oqYLcHQ9NqXHudC6YBM",
            "ids": ["0", "1"]
        }
    ],
    "blockheight": 50868,
    "salt": "80d87a8bd5cf2a3eca9037c2229f3701eed29360caa975531ef5fe476b1b70b5"
}

```



#### Transaction Entry JSON Field Summary & Validation

| Name                 | Type   | Description                                                  | Validation                                                   | Required |
| -------------------- | ------ | ------------------------------------------------------------ | ------------------------------------------------------------ | -------- |
| `inputs`             | array  | The inputs of this this transaction                          |                                                              | Y        |
| `inputs[n]`          | object | The output object for this transaction                       |                                                              | Y        |
| `inputs[n].address`  | string | The Factoid address to send tokens from                      | Valid public Factoid address                                 | Y        |
| `inputs[n].ids`      | array  | Token ids of tokens that are an input of the transaction     | Length > 0                                                   | Y        |
|                      |        |                                                              |                                                              |          |
| `outputs`            | array  | The outputs  of this transaction                             |                                                              | Y        |
| `outputs[n]`         | object | The output object for this transaction                       |                                                              | Y        |
| `outputs[n].address` | string | The Factoid address to send tokens from                      | Valid public Factoid address                                 | Y        |
| `outputs[n].ids`     | array  | Token ids of tokens that are an output of the transaction    | Length > 0. See validation criteria below                    | Y        |
|                      |        |                                                              |                                                              |          |
| `blockheight`        | number | The approximate Factom blockheight when the transaction was committed | Positive integer. The Factom blockheight when the transaction is committed must be `blockheight` +/- 3 | Y        |
|                      |        |                                                              |                                                              |          |
| `salt`               | string | Random string to be hashed into nonce                        | User defined, optional                                       | N\*      |

**\* = required for coinbase transaction**

#### Transaction Entry External IDs `extends` [FATIP-0](0.md)



### Transaction Validation and State `extends` [FATIP-0](0.md)

#### Computing the current state `extends` [FATIP-0](0.md)

The standard follows the general state computation guidelines of FAT-0, except for the specific pseudocode and requirements. The following pseudo code describes how to compute the current state of all balances:

```
for entry in transaction_chain.entries:
    if entry.is_valid_transaction():
        if !entry.is_coinbase_transaction():
            for input in entry.inputs:
                balances[input.address].removeAll(input.ids)
        for output in entry.outputs:
            balances[output.address].concat(output.ids)
```

#### 

#### Transaction Validation Requirements

All Transactions must meet all of the T.x requirements.

Normal Transactions must also meet all of the N.x requirements.

Coinbase Transactions must also meet all of the C.x requirements.

In general, requirements are ordered by the computational and programmatic ease
of checking.

The x.1.x requirements are generally data structure validations.

The x.2.x requirements are generally parsing and other content validations.

The x.3.x requirements are generally related to cryptographic validations.

##### T.x Requirements for all transactions

- T.1.1: The content of the entry must be a single well-formed JSON.
- T.1.2: The JSON must contain all required transaction fields listed in the above table.
- T.1.3: The `inputs` and `outputs` arrays must not be empty.
- T.1.4: The `inputs` and `outputs` arrays must only contain objects with only
  the two required fields listed in the above table, `address` and `ids`.
- T.2.1: All `address` fields in the `inputs` and `outputs` arrays must contain a
  valid human readable public Factoid Address.
- T.2.2: No Factoid Address may be used in more than one input or output. e.g.
  No input or output array with multiple amounts from or to the same address.
  No transactions that use an input address in one of the outputs.
- T.2.3: The `ids` field in the objects in the `inputs` and `outputs` arrays must be arrays of string token IDs with at least one element.
- T.2.4: The collection of all `ids` contained in `inputs` may not contain duplicates. The collection of all `ids` contained in `outputs` may not contain duplicates. 
- T.2.5: The set of all `ids` in `inputs` must equal the set of all `ids` in `outputs`. 
- T.2.5: The set of all `ids` in `inputs` must have been issued

##### N.x Requirements for normal account-to-account transactions

Normal transactions must meet all T.x and N.x requirements.

All references to External ID indexes use `0`-based indexing.

- N.1.1: The entry must contain a minimum of `2n` External IDs, where `n` is
  the length of the `inputs` array.
- N.2.1: The `blockheight` must be within 3 blocks of the entry's recorded
  Factom blockheight. In other words, if `currentblockheight` is the blockheight when the
  entry was recorded into the Factom blockchain, then `blockheight` must be in the
  range `[currentblockheight - 3, currentblockheight + 3]`, inclusive.
- N.2.2: The Coinbase address
  (`FA1zT4aFpEvcnPqPCigB3fvGu4Q4mTXY22iiuV69DqE1pNhdF2MC`) may not be used in
  the `address` fields for any `inputs`.
- N.2.3: The `ids` field for all `inputs` must represent token ID's belonging to the balance of `address`.
- N.2.4: All signatures in the odd External IDs must be unique across all
  previous valid transactions. Note that requirement N.2.1 allows that
  uniqueness only needs to be checked among valid transactions within the past 12
  hours.
- N.3.1: If `i` is even and within the first `2n` External IDs, then the `i`th External ID must be the raw data of an
  RCD which hashes to the raw data payload of the human readable Factoid
  Address in `inputs[i/2].address`.
- N.3.2: If `i` is odd  and within the first `2n` External IDs, then the `i`th External ID must be the raw data of a
  valid signature of the raw bytes of the chain id bytes prepended to the
  content of the entry, verified against the public key stored in the RCD in the
  `i-1`th External ID.

##### C.x Requirements for Coinbase distribution transactions

Coinbase transactions must meet all T.x and C.x requirements.

- C.1.1: The `inputs` array must contain a single input.
- C.1.2 The value of `inputs[0].address` must equal be to
  `FA1zT4aFpEvcnPqPCigB3fvGu4Q4mTXY22iiuV69DqE1pNhdF2MC`.
- C.1.3: All token IDs in `inputs[0].ids` must have been issued
- C.1.4: All token IDs in `inputs[0].ids` must not be in circulation
- C.2.1: The last ExtID of the entry must be a valid signature of `token chain id + entry content` by the SK1 key of the token Issuer.

# Implementation

No implementation notes at this time


# Copyright

Copyright and related rights waived via
[CC0](https://creativecommons.org/publicdomain/zero/1.0/).
